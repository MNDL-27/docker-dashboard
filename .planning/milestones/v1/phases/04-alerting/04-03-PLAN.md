---
phase: 4
plan: 03
wave: 3
depends_on: [01, 02]
files_modified:
  - apps/web/src/app/(dashboard)/alerts/page.tsx
  - apps/web/src/app/(dashboard)/alerts/rules/page.tsx
  - apps/web/src/app/(dashboard)/settings/webhooks/page.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can view active and historical Alerts"
    - "User can create, edit, and delete Alert Rules"
    - "User can configure Webhook endpoint URLs"
  artifacts:
    - path: "apps/web/src/app/(dashboard)/alerts/page.tsx"
      provides: "Alert history and active firing dashboard"
    - path: "apps/web/src/components/alerts/RuleBuilder.tsx"
      provides: "Form to construct alerting thresholds"
---

# Plan 04-03: Alerting Web UI

<objective>
Build the user interfaces required for users to view firing alerts, configure their alert rules, and set up webhook destinations in their Organization settings.
</objective>

<context>
Load for context:
- .planning/ROADMAP.md
- apps/api/src/routes/webhooks.ts (created in 04-02)
- apps/api/src/routes/alerts.ts (to be consumed)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Alerts Dashboard</name>
  <files>
    apps/web/src/app/(dashboard)/alerts/page.tsx
  </files>
  <action>
Create the main Alerts page (`/alerts`).
- Fetch standard `Alert` array from `apiFetch('/api/alerts')`.
- Show a prominent top section for `FIRING` alerts with red/amber badges.
- Show a historical table below for `RESOLVED` alerts.
- Data columns: Rule Name, Container Name, Status, Started At, Resolved At.
  </action>
  <verify>Navigate to /alerts in dev server and verify UI renders cleanly.</verify>
  <done>Alert dashboard successfully displays the two lifecycle states.</done>
</task>

<task type="auto">
  <name>Task 2: Build Alert Rules Management</name>
  <files>
    apps/web/src/app/(dashboard)/alerts/rules/page.tsx
    apps/web/src/components/alerts/RuleBuilder.tsx
  </files>
  <action>
Create the Rules configuration page (`/alerts/rules`).
- Implement a table showing existing `AlertRule` entries.
- Implement a `RuleBuilder` modal/form to create new rules:
  - Select Condition (Dropdown: Container Down, Restart Loop, CPU %, Memory bytes).
  - Input Threshold (Number).
  - Input Duration (Minutes to wait before firing).
- Send to `POST /api/alerts/rules`.
  </action>
  <verify>Create a rule via the UI and verify network payload succeeds.</verify>
  <done>Users can successfully articulate alert criteria.</done>
</task>

<task type="auto">
  <name>Task 3: Build Webhook Settings</name>
  <files>
    apps/web/src/app/(dashboard)/settings/webhooks/page.tsx
  </files>
  <action>
Create the Webhook management page under the existing Settings route if it exists, or create it (`/settings/webhooks`).
- Form to add a new Webhook: URL input and optional Secret input.
- List existing Webhooks with a toggle switch to pause/activate (`isActive`).
- Call `apiFetch('/api/webhooks')` for data operations.
  </action>
  <verify>Input a RequestBin URL and verify it saves to the database API.</verify>
  <done>Webhook configurations are fully manageable.</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] `/alerts`, `/alerts/rules`, and `/settings/webhooks` layouts match the existing dashboard aesthetics.
- [ ] Full end-to-end trace: Creating a rule and simulating a container crash reflects on the `/alerts` page.
- [ ] Requirements ALRT-01 through ALRT-07 are visibly satisfied by the UI and underlying logic.
</verification>

<success_criteria>
- [ ] Phase 4 Alerting workflows are complete and ready for User Acceptance.
</success_criteria>
